# render.yaml — Render Blueprint for WardrobeWizard
# Uses an existing PostgreSQL database (provided via DATABASE_URL)

services:
  # ── 1. Flask Backend ────────────────────────────────────────────────────────
  - type: web
    name: wardrobewizard-backend
    runtime: python
    rootDir: backend
    buildCommand: "pip install -r requirements.txt"
    startCommand: "gunicorn app:app --bind 0.0.0.0:$PORT"
    envVars:
      - key: DATABASE_URL
        value: postgresql://aicr:uWyX1bKpQhjGEMpBDtTwVESHBeJ9Y5sf@dpg-d68s7ng6fj8s73c8o81g-a.oregon-postgres.render.com/carrier_fxm9
      - key: SECRET_KEY
        generateValue: true
      - key: OPENWEATHER_API_KEY
        sync: false # Enter this manually in the Render dashboard

  # ── 2. Static Frontend ──────────────────────────────────────────────────────
  - type: web
    name: wardrobewizard-frontend
    runtime: static
    rootDir: frontend
    staticPublishPath: .
    headers:
      - path: /*
        name: Cache-Control
        value: no-cache
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
